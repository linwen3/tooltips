/*! tooltips 2013-12-06 09:59:33 */
KISSY.add("pi/tooltips/align",function(a,b){function c(a){var b,c=a.ownerDocument,d=c.body,e=q(a).css("position"),f="fixed"==e||"absolute"==e;if(!f)return"html"==a.nodeName.toLowerCase()?null:a.parentNode;for(b=a.parentNode;b&&b!=d;b=b.parentNode)if(e=q(b).css("position"),"static"!=e)return b;return null}function d(a){var b,d,e,f,g={left:0,right:1/0,top:0,bottom:1/0},h=a.ownerDocument,i=q(h).getWindow(),j=h.body,k=h.documentElement;for(b=a;b=c(b);)if((!r.ie||0!=b.clientWidth)&&b!=j&&b!=k&&"visible"!=q(b).css("overflow")){var l=q(b).offset();l.left+=b.clientLeft,l.top+=b.clientTop,g.top=Math.max(g.top,l.top),g.right=Math.min(g.right,l.left+b.clientWidth),g.bottom=Math.min(g.bottom,l.top+b.clientHeight),g.left=Math.max(g.left,l.left)}return d=i.scrollLeft(),e=i.scrollTop(),g.left=Math.max(g.left,d),g.top=Math.max(g.top,e),f={width:i.width(),height:i.height()},g.right=Math.min(g.right,d+f.width),g.bottom=Math.min(g.bottom,e+f.height),g.top>=0&&g.left>=0&&g.bottom>g.top&&g.right>g.left?g:null}function e(a,b,c,d){var e,f,g,h;return e={left:a.left,top:a.top},g=l(b,c[0]),h=l(a,c[1]),f=[h.left-g.left,h.top-g.top],{left:e.left-f[0]+ +d[0],top:e.top-f[1]+ +d[1]}}function f(a,b,c){return a.left<c.left||a.left+b.width>c.right}function g(a,b,c){return a.top<c.top||a.top+b.height>c.bottom}function h(b,c,d){var e=[];return a.each(b,function(a){e.push(a.replace(c,function(a){return d[a]}))}),e}function i(a,b){return a[b]=-a[b],a}function j(){}function k(b){var c,d,e,f=b[0];if(a.isWindow(f)){var g=q(f).getWindow();c={left:g.scrollLeft(),top:g.scrollTop()},d=g.width(),e=g.height()}else c=b.offset(),d=b.outerWidth(),e=b.outerHeight();return c.width=d,c.height=e,c}function l(a,b){var c,d,e=b.charAt(0),f=b.charAt(1),g=a.width,h=a.height;return c=a.left,d=a.top,"c"===e?d+=h/2:"b"===e&&(d+=h),"c"===f?c+=g/2:"r"===f&&(c+=g),{left:c,top:d}}function m(a){a.target==this&&a.newVal&&o.call(this)}function n(){this.get("visible")&&o.call(this)}function o(){this._onSetAlign(this.get("align"))}var p=a.Env.host,q=b.all,r=a.UA;return j.__getOffsetParent=c,j.__getVisibleRectForElement=d,j.ATTRS={align:{value:{}}},j.prototype={__bindUI:function(){var a=this;a.on("beforeVisibleChange",m,a),a.$el.getWindow().on("resize",n,a)},_onSetAlign:function(a){a&&a.points&&this.align(a.node,a.points,a.offset,a.overflow)},align:function(c,j,l,m){c=b.one(c||p),l=l&&[].concat(l)||[0,0],m=m||{};var n=this,o=n.$el,q=0,r=d(o[0]),s=k(o),t=k(c),u=e(s,t,j,l),v=a.merge(s,u);return r&&(m.adjustX||m.adjustY)&&(f(u,s,r)&&(q=1,j=h(j,/[lr]/gi,{l:"r",r:"l"}),l=i(l,0)),g(u,s,r)&&(q=1,j=h(j,/[tb]/gi,{t:"b",b:"t"}),l=i(l,1)),q&&(u=e(s,t,j,l),a.mix(v,u))),n.set({x:v.left,y:v.top},{force:1}),v.width!=s.width&&n.set("width",o.width()+v.width-s.width),v.height!=s.height&&n.set("height",o.height()+v.height-s.height),n.realAlign={node:c,points:j,offset:[v.left,v.top]},n},center:function(a){var b=this;return b.set("align",{node:a,points:["cc","cc"],offset:[0,0]}),b},__destructor:function(){this.$el&&this.$el.getWindow().detach("resize",o,this)}},j},{requires:["node"]}),KISSY.add("pi/tooltips/index",function(a,b,c,d,e,f,g){var h=a.all,i=h("body"),f=(a.DOM,a.Overlay),j="pi-",k="J_toolTipsBd",l=c.extend({initializer:function(){var a=this;a.align=new g,a._initPop(),a._bindEvent()},_initPop:function(){var a=this,b=a.getAttrVals(),c=h(new e(a.get("tpl")).render(b)).appendTo(i),g={};6==d.ie||a.get("fixSize")?(g.width=a.get("maxWidth"),g.height=a.get("maxHeight")):(g["max-width"]=a.get("maxWidth"),g["max-height"]=a.get("maxHeight")),c.style("z-index",a.get("zIndex")),a.popup=new f.Popup({srcNode:c,effect:{effect:a.get("effect"),duration:a.get("duration")}}),a.newAlign=b.align,a.popup.align=a.align.align,a.popup.render(),a.tipsNode=c,a.bdNode=a.tipsNode.one("."+k),a.bdNode.style(g)},_bindEvent:function(){var b=this,c=b.getAttrVals();if(c.triggerNode){if("mouse"==c.eventType){var d=function(){b._mouseHideLater&&b._mouseHideLater.cancel()};if(i.delegate("mouseover",c.triggerNode,function(a){d(),b._show(a)}),b.tipsNode.on("mouseenter",d),c.outSideHide){var e=function(){d(),b._mouseHideLater=a.later(function(){b._hide()},100)};i.delegate("mouseout",c.triggerNode,e),b.tipsNode.on("mouseleave",e)}}"click"==c.eventType&&(i.delegate("click",c.triggerNode,b.show,b),c.outSideHide&&(b.on("show",function(){WIN.on("keydown",b._outSideClick,b)}),b.on("hide",function(){WIN.detach("click",b._outSideClick,b)})))}b.on("afterHockingChange",b._addHocking),b.on("afterMaxWidthChange",b._setMaxWidth),b.on("afterMaxHeightChange",b._setMaxHeight),b.on("afterZIndexChange",b._setZIndex,b)},_outSideClick:function(a){var b=this,c=a.target;c===b.contentNode[0]||b.contentNode.contains(c)||b._hide()},_show:function(b){var c=this,d=c.getAttrVals(),e=d.referNode||h(b.currentTarget);return d.delayOut&&c._hideLater&&c._hideLater.cancel(),d.delayIn?(c._showLater&&c._showLater.cancel(),c._showLater=a.later(function(){c.show(e)},d.delayIn),void 0):(c.show(e),void 0)},show:function(a,b,c,d){var e=this;b&&e.setContent(b),c&&e.setMaxWidth(c),d&&e.setMaxHeight(d);var f=e.getAttrVals();b||(b=f.contentAttr?a.attr(f.contentAttr):""),b=b?b:f.content,e.bdNode.html(b),e.setAlign(a),e.fire("beforeShow"),e.popup.show(),e.fire("afterShow"),e._addHocking()},isShowing:function(){return self.popup.get("visible")},_hide:function(){var b=this,c=b.getAttrVals();return c.delayIn&&b._showLater&&b._showLater.cancel(),c.delayOut?(b._hideLater&&b._hideLater.cancel(),b._hideLater=a.later(function(){b.hide()},c.delayOut),void 0):(b.hide(),void 0)},hide:function(){var a=this;a.fire("beforeHide"),a.popup.hide(),a.fire("afterHide"),a._removeHocking()},setContent:function(a){return this.set("content",a),this},setContentAttr:function(a){return this.set("contentAttr",a),this},setMaxWidth:function(a){return this.set("maxWidth",a),this},_setMaxWidth:function(){var a=this,b="maxWidth";(6==d.ie||a.get("fixSize"))&&(b="width"),a.bdNode.css(b,a.get("maxWidth"))},setMaxHeight:function(a){return this.set("maxHeight",a),this},_setMaxHeight:function(){var a=this,b="maxHeight";(6==d.ie||a.get("fixSize"))&&(b="height"),a.bdNode.css(b,a.get("maxHeight"))},_setZIndex:function(){return self.contentNode.css("zIndex",self.get("zIndex")),this},setAlign:function(a){var b=this,c=b.getAttrVals(),d=c.align,e=c.offset;return c.hocking||!c.viewPort?(b.popup.align(a,d,e),void 0):(c.viewPort&&(b.popup.align(a,d,e,{adjustX:1,adjustY:1}),b.tipsNode.removeClass("pi-toolTips-"+b.newAlign[1]),b.newAlign=b.popup.realAlign.points,b.tipsNode.addClass("pi-toolTips-"+b.newAlign[1])),void 0)},setHocking:function(a){this.set("hocking",a)},_addHocking:function(){var a=this,b=a.get("hocking");b&&a.isShowing&&i.on("mousemove",a._hocking,a)},_removeHocking:function(){var a=this;i.detach("mousemove",a._hocking,a)},_hocking:function(a){var b=this,c=b.get("offset"),d=[a.pageX,a.pageY];d[0]=d[0]+c[0],d[1]=d[1]+c[1],b.popup.move(d[0],d[1])}},{ATTRS:{tpl:{value:'<div class="{{prefixCls}}toolTips {{prefixCls}}toolTips-{{#each align}}{{#if xindex}}{{this}}{{/if}}{{/each}}">{{#if arrow}}<div class="{{prefixCls}}toolTips-arrow"><span></span></div>{{/if}}<div class="{{prefixCls}}toolTips-bd"><div class="{{prefixCls}}toolTips-box ks-popup-content J_toolTipsBd">{{content}}</div></div></div>'},triggerNode:{value:null},referNode:{value:null},arrow:{value:!0},eventType:{value:"mouse"},outSideHide:{value:!0},content:{value:""},contentAttr:{value:""},prefixCls:{value:j},fixSize:{value:!1},maxWidth:{value:"auto"},maxHeight:{value:"auto"},align:{value:["bl","tl"]},offset:{value:[0,0]},zIndex:{value:1e4},viewPort:{value:!0},hocking:{value:!1},delayIn:{value:0},delayOut:{value:0},effect:{value:""},duration:{value:0}}});return l},{requires:["node","rich-base","ua","xtemplate","overlay","./align"]});